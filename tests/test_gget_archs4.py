import unittest
from gget.gget_archs4 import archs4

from .fixtures import ARCHS4_FUNDC1, ARCHS4_FUNDC1_TISSUE, ARCHS4_FUNDC1_TISSUE_MOUSE


class TestArchs4(unittest.TestCase):
    def test_archs4(self):
        df = archs4("FUNDC1")
        result_to_test = df.values.tolist()
        expected_result = ARCHS4_FUNDC1

        self.assertListEqual(result_to_test, expected_result)

    def test_archs4_mouse(self):
        df = archs4("FUNDC1", species="mouse")
        result_to_test = df.values.tolist()
        expected_result = ARCHS4_FUNDC1

        self.assertListEqual(result_to_test, expected_result)

    def test_archs4_mouse_json(self):
        result_to_test = archs4("FUNDC1", species="mouse", json=True)
        expected_result = {
            "1": {"gene_symbol": "VBP1", "pearson_correlation": 0.537270844},
            "2": {"gene_symbol": "SNRPB2", "pearson_correlation": 0.5164885521},
            "3": {"gene_symbol": "PCMT1", "pearson_correlation": 0.5021503568},
            "4": {"gene_symbol": "MRPL47", "pearson_correlation": 0.5008688569},
            "5": {"gene_symbol": "NFU1", "pearson_correlation": 0.498568058},
            "6": {"gene_symbol": "MRPS36", "pearson_correlation": 0.4980320334},
            "7": {"gene_symbol": "MZT1", "pearson_correlation": 0.4923032224},
            "8": {"gene_symbol": "PIN4", "pearson_correlation": 0.4917503297},
            "9": {"gene_symbol": "HPF1", "pearson_correlation": 0.4916711152},
            "10": {"gene_symbol": "POLR2K", "pearson_correlation": 0.4913628399},
            "11": {"gene_symbol": "NDUFA12", "pearson_correlation": 0.49017784},
            "12": {"gene_symbol": "THOC7", "pearson_correlation": 0.4886467755},
            "13": {"gene_symbol": "NDUFA8", "pearson_correlation": 0.483466208},
            "14": {"gene_symbol": "SF3B6", "pearson_correlation": 0.4817165732},
            "15": {"gene_symbol": "SUMO1", "pearson_correlation": 0.4786758721},
            "16": {"gene_symbol": "SNRPG", "pearson_correlation": 0.4754211605},
            "17": {"gene_symbol": "MRPL51", "pearson_correlation": 0.4741184115},
            "18": {"gene_symbol": "RPL26L1", "pearson_correlation": 0.4737442136},
            "19": {"gene_symbol": "POMP", "pearson_correlation": 0.4726703465},
            "20": {"gene_symbol": "FKBP3", "pearson_correlation": 0.4725118279},
            "21": {"gene_symbol": "AK6", "pearson_correlation": 0.4721378684},
            "22": {"gene_symbol": "MRPL13", "pearson_correlation": 0.4689649642},
            "23": {"gene_symbol": "LSM1", "pearson_correlation": 0.4684693515},
            "24": {"gene_symbol": "COA6", "pearson_correlation": 0.4679728448},
            "25": {"gene_symbol": "PSMD10", "pearson_correlation": 0.4679265916},
            "26": {"gene_symbol": "NDUFB3", "pearson_correlation": 0.4673668146},
            "27": {"gene_symbol": "TIMM9", "pearson_correlation": 0.4672335386},
            "28": {"gene_symbol": "NDUFAF2", "pearson_correlation": 0.4650345147},
            "29": {"gene_symbol": "GPN3", "pearson_correlation": 0.4649380445},
            "30": {"gene_symbol": "SARNP", "pearson_correlation": 0.4635923207},
            "31": {"gene_symbol": "TTC1", "pearson_correlation": 0.4627500474},
            "32": {"gene_symbol": "DPY30", "pearson_correlation": 0.4622517228},
            "33": {"gene_symbol": "PFDN4", "pearson_correlation": 0.4616999328},
            "34": {"gene_symbol": "TPRKB", "pearson_correlation": 0.4616912305},
            "35": {"gene_symbol": "MRPL15", "pearson_correlation": 0.4613937438},
            "36": {"gene_symbol": "ACP1", "pearson_correlation": 0.4593632221},
            "37": {"gene_symbol": "COPS3", "pearson_correlation": 0.4585328996},
            "38": {"gene_symbol": "TXNDC9", "pearson_correlation": 0.4581524432},
            "39": {"gene_symbol": "NDUFAB1", "pearson_correlation": 0.4576360583},
            "40": {"gene_symbol": "COPS4", "pearson_correlation": 0.4554952383},
            "41": {"gene_symbol": "ATP5J", "pearson_correlation": 0.4554341137},
            "42": {"gene_symbol": "HCCS", "pearson_correlation": 0.4554041624},
            "43": {"gene_symbol": "C1D", "pearson_correlation": 0.455129981},
            "44": {"gene_symbol": "HPRT1", "pearson_correlation": 0.4550098479},
            "45": {"gene_symbol": "C14orf142", "pearson_correlation": 0.4539367855},
            "46": {"gene_symbol": "YEATS4", "pearson_correlation": 0.4533015192},
            "47": {"gene_symbol": "ZCRB1", "pearson_correlation": 0.4532633424},
            "48": {"gene_symbol": "CHCHD1", "pearson_correlation": 0.452947557},
            "49": {"gene_symbol": "FAM103A1", "pearson_correlation": 0.452286005},
            "50": {"gene_symbol": "ERH", "pearson_correlation": 0.4521385133},
            "51": {"gene_symbol": "SNRPC", "pearson_correlation": 0.451059401},
            "52": {"gene_symbol": "SNRPE", "pearson_correlation": 0.4507854879},
            "53": {"gene_symbol": "CETN2", "pearson_correlation": 0.4505807161},
            "54": {"gene_symbol": "SNRNP27", "pearson_correlation": 0.4498781264},
            "55": {"gene_symbol": "LSM3", "pearson_correlation": 0.4497714937},
            "56": {"gene_symbol": "METTL5", "pearson_correlation": 0.4483890235},
            "57": {"gene_symbol": "TRIAP1", "pearson_correlation": 0.4466838241},
            "58": {"gene_symbol": "ZCCHC17", "pearson_correlation": 0.4456448555},
            "59": {"gene_symbol": "USMG5", "pearson_correlation": 0.4440298975},
            "60": {"gene_symbol": "NDUFB6", "pearson_correlation": 0.4435827136},
            "61": {"gene_symbol": "POLR2G", "pearson_correlation": 0.4419304132},
            "62": {"gene_symbol": "CISD1", "pearson_correlation": 0.4416078627},
            "63": {"gene_symbol": "TOMM5", "pearson_correlation": 0.4411735237},
            "64": {"gene_symbol": "DRG1", "pearson_correlation": 0.4410737157},
            "65": {"gene_symbol": "MRPL18", "pearson_correlation": 0.4407820404},
            "66": {"gene_symbol": "DPM1", "pearson_correlation": 0.4407093227},
            "67": {"gene_symbol": "MKKS", "pearson_correlation": 0.4400700331},
            "68": {"gene_symbol": "GPN1", "pearson_correlation": 0.4400257766},
            "69": {"gene_symbol": "PSMA4", "pearson_correlation": 0.4390216172},
            "70": {"gene_symbol": "CHMP5", "pearson_correlation": 0.4387759268},
            "71": {"gene_symbol": "NDUFA6", "pearson_correlation": 0.4387527108},
            "72": {"gene_symbol": "PWP1", "pearson_correlation": 0.4386344254},
            "73": {"gene_symbol": "MEA1", "pearson_correlation": 0.4385516942},
            "74": {"gene_symbol": "PDZD11", "pearson_correlation": 0.4378166795},
            "75": {"gene_symbol": "TSN", "pearson_correlation": 0.4366511703},
            "76": {"gene_symbol": "TMEM14C", "pearson_correlation": 0.4359767139},
            "77": {"gene_symbol": "MCTS1", "pearson_correlation": 0.4354334176},
            "78": {"gene_symbol": "TRMT10C", "pearson_correlation": 0.434738487},
            "79": {"gene_symbol": "C14orf166", "pearson_correlation": 0.4346600473},
            "80": {"gene_symbol": "CHCHD4", "pearson_correlation": 0.4341895282},
            "81": {"gene_symbol": "TMEM126B", "pearson_correlation": 0.433988899},
            "82": {"gene_symbol": "MRPL1", "pearson_correlation": 0.4335901141},
            "83": {"gene_symbol": "PSMC2", "pearson_correlation": 0.4334204197},
            "84": {"gene_symbol": "PSMD14", "pearson_correlation": 0.4332588315},
            "85": {"gene_symbol": "MED31", "pearson_correlation": 0.4317766726},
            "86": {"gene_symbol": "MRPL36", "pearson_correlation": 0.4312921464},
            "87": {"gene_symbol": "CDC26", "pearson_correlation": 0.4312804341},
            "88": {"gene_symbol": "STRAP", "pearson_correlation": 0.430878073},
            "89": {"gene_symbol": "ASNSD1", "pearson_correlation": 0.4308263063},
            "90": {"gene_symbol": "MRPL39", "pearson_correlation": 0.4301603436},
            "91": {"gene_symbol": "SNRPF", "pearson_correlation": 0.4294155836},
            "92": {"gene_symbol": "MRPL33", "pearson_correlation": 0.4293196201},
            "93": {"gene_symbol": "PAK1IP1", "pearson_correlation": 0.4291466177},
            "94": {"gene_symbol": "TIMM8B", "pearson_correlation": 0.4290695786},
            "95": {"gene_symbol": "TIMM23", "pearson_correlation": 0.4286460876},
            "96": {"gene_symbol": "VDAC3", "pearson_correlation": 0.4285482764},
            "97": {"gene_symbol": "PSMA2", "pearson_correlation": 0.428375721},
            "98": {"gene_symbol": "BCAS2", "pearson_correlation": 0.4283214509},
            "99": {"gene_symbol": "NOL7", "pearson_correlation": 0.4277236462},
            "100": {"gene_symbol": "CCDC43", "pearson_correlation": 0.4275307953},
        }

        self.assertEqual(result_to_test, expected_result)

    def test_archs4_tissue(self):
        df = archs4("fuNdC1", which="tissue")
        result_to_test = df.values.tolist()
        expected_result = ARCHS4_FUNDC1_TISSUE

        self.assertListEqual(result_to_test, expected_result)

    def test_archs4_tissue_json(self):
        result_to_test = archs4("fuNdC1", which="tissue", json=True)
        expected_result = {
            "0": {
                "id": "System.Digestive System.Stomach.GASTRIC EPITHELIAL CELL",
                "min": 7.32347,
                "q1": 8.11491,
                "median": 8.46069,
                "q3": 8.81085,
                "max": 9.07661,
            },
            "1": {
                "id": "System.Cardiovascular System.Heart.VENTRICLE",
                "min": 6.59685,
                "q1": 7.64806,
                "median": 8.37793,
                "q3": 8.77715,
                "max": 9.20011,
            },
            "2": {
                "id": "System.Urogenital/Reproductive System.Ovary.OOCYTE",
                "min": 5.96308,
                "q1": 7.27055,
                "median": 8.37004,
                "q3": 9.19374,
                "max": 10.1503,
            },
            "3": {
                "id": "System.Cardiovascular System.Heart.HEART",
                "min": 4.56034,
                "q1": 6.93534,
                "median": 8.09316,
                "q3": 9.40669,
                "max": 9.96257,
            },
            "4": {
                "id": "System.Respiratory System.Lung.LUNG EPITHELIAL CELL",
                "min": 6.53826,
                "q1": 7.35874,
                "median": 7.91354,
                "q3": 8.6884,
                "max": 9.67239,
            },
            "5": {
                "id": "System.Urogenital/Reproductive System.Ovary.GRANULOSA",
                "min": 3.96034,
                "q1": 7.10546,
                "median": 7.89588,
                "q3": 8.4916,
                "max": 9.48356,
            },
            "6": {
                "id": "System.Nervous System.PNS.MOTOR NEURON",
                "min": 0.113644,
                "q1": 6.68963,
                "median": 7.65305,
                "q3": 9.63751,
                "max": 10.5849,
            },
            "7": {
                "id": "System.Digestive System.Pancreas.BETA CELL",
                "min": 0.113644,
                "q1": 6.27464,
                "median": 7.59973,
                "q3": 8.12035,
                "max": 10.146,
            },
            "8": {
                "id": "System.Nervous System.Eye.RETINA",
                "min": 0.113644,
                "q1": 6.71468,
                "median": 7.49163,
                "q3": 8.24232,
                "max": 9.46687,
            },
            "9": {
                "id": "System.Immune System.Lymphoid.PLASMACYTOID DENDRITIC CELL",
                "min": 6.27753,
                "q1": 7.24729,
                "median": 7.48062,
                "q3": 7.65305,
                "max": 8.01182,
            },
            "10": {
                "id": "System.Respiratory System.Trachea.TRACHEA",
                "min": 4.95083,
                "q1": 6.86236,
                "median": 7.44713,
                "q3": 8.23902,
                "max": 9.2296,
            },
            "11": {
                "id": "System.Nervous System.PNS.SENSORY NEURON",
                "min": 6.31883,
                "q1": 7.05469,
                "median": 7.33897,
                "q3": 7.82052,
                "max": 8.08543,
            },
            "12": {
                "id": "System.Immune System.Granulocytic.GRANULOCYTE",
                "min": 4.70828,
                "q1": 6.32207,
                "median": 7.30823,
                "q3": 7.99758,
                "max": 8.80481,
            },
            "13": {
                "id": "System.Urogenital/Reproductive System.Kidney.KIDNEY",
                "min": 2.77595,
                "q1": 6.31418,
                "median": 7.30561,
                "q3": 8.27579,
                "max": 9.33719,
            },
            "14": {
                "id": "System.Urogenital/Reproductive System.Breast.BREAST",
                "min": 1.20968,
                "q1": 6.41035,
                "median": 7.28076,
                "q3": 7.95899,
                "max": 9.62639,
            },
            "15": {
                "id": "System.Immune System.Thymus.THYMOCYTE",
                "min": 5.06772,
                "q1": 6.62962,
                "median": 7.25523,
                "q3": 8.61253,
                "max": 9.23107,
            },
            "16": {
                "id": "System.Cardiovascular System.Heart.ATRIUM",
                "min": 2.25266,
                "q1": 4.70226,
                "median": 7.2373,
                "q3": 8.05503,
                "max": 8.44642,
            },
            "17": {
                "id": "System.Urogenital/Reproductive System.Breast.MAMMARY GLAND",
                "min": 5.37679,
                "q1": 6.76248,
                "median": 7.21826,
                "q3": 7.77696,
                "max": 8.73712,
            },
            "18": {
                "id": "System.Integumentary System.Skin.KERATINOCYTE",
                "min": 6.00081,
                "q1": 6.86236,
                "median": 7.18296,
                "q3": 7.62057,
                "max": 8.60009,
            },
            "19": {
                "id": "System.Nervous System.CNS.HYPOTHALAMUS",
                "min": 3.44188,
                "q1": 6.63774,
                "median": 7.14836,
                "q3": 7.99022,
                "max": 8.81727,
            },
            "20": {
                "id": "System.Nervous System.CNS.THALAMUS",
                "min": 3.29066,
                "q1": 5.995,
                "median": 7.14836,
                "q3": 7.83426,
                "max": 8.71165,
            },
            "21": {
                "id": "System.Immune System.Lymphoid.BLYMPHOCYTE",
                "min": 5.57377,
                "q1": 6.73422,
                "median": 7.13892,
                "q3": 7.90918,
                "max": 9.73769,
            },
            "22": {
                "id": "System.Integumentary System.Skin.BASAL CELL",
                "min": 5.05913,
                "q1": 6.27464,
                "median": 7.10985,
                "q3": 7.62057,
                "max": 9.24075,
            },
            "23": {
                "id": "System.Nervous System.CNS.NEURON",
                "min": 0.113644,
                "q1": 6.4358,
                "median": 7.10985,
                "q3": 8.02584,
                "max": 10.0564,
            },
            "24": {
                "id": "System.Integumentary System.Skin.MELANOCYTE",
                "min": 5.55657,
                "q1": 6.85546,
                "median": 7.10033,
                "q3": 7.48267,
                "max": 7.92732,
            },
            "25": {
                "id": "System.Digestive System.Pancreas.ALPHA CELL",
                "min": 0.113644,
                "q1": 0.113644,
                "median": 7.04658,
                "q3": 8.82375,
                "max": 10.7258,
            },
            "26": {
                "id": "System.Connective Tissue.Bone.STROMAL CELL",
                "min": 0.113644,
                "q1": 6.57131,
                "median": 7.01742,
                "q3": 7.91929,
                "max": 9.83458,
            },
            "27": {
                "id": "System.Urogenital/Reproductive System.Kidney.PODOCYTE",
                "min": 6.15985,
                "q1": 6.71742,
                "median": 7.00003,
                "q3": 7.31342,
                "max": 8.29019,
            },
            "28": {
                "id": "System.Muscular System.Skeletal muscle.SKELETAL MUSCLE",
                "min": 0.113644,
                "q1": 6.35023,
                "median": 6.9828,
                "q3": 7.42671,
                "max": 8.89625,
            },
            "29": {
                "id": "System.Immune System.Myeloid.MACROPHAGE",
                "min": 0.113644,
                "q1": 6.51705,
                "median": 6.9754,
                "q3": 7.38198,
                "max": 8.46912,
            },
            "30": {
                "id": "System.Immune System.Lymphoid.TLYMPHOCYTE",
                "min": 5.60813,
                "q1": 6.60849,
                "median": 6.9754,
                "q3": 7.26685,
                "max": 7.85409,
            },
            "31": {
                "id": "System.Connective Tissue.Bone marrow.CHONDROCYTE",
                "min": 5.93985,
                "q1": 6.45202,
                "median": 6.9754,
                "q3": 7.44552,
                "max": 8.78176,
            },
            "32": {
                "id": "System.Nervous System.CNS.ASTROCYTE",
                "min": 1.20968,
                "q1": 6.4358,
                "median": 6.95675,
                "q3": 7.42671,
                "max": 8.33012,
            },
            "33": {
                "id": "System.Respiratory System.Lung.LUNG",
                "min": 0.113644,
                "q1": 5.88569,
                "median": 6.95675,
                "q3": 7.7752,
                "max": 9.18212,
            },
            "34": {
                "id": "System.Muscular System.Skeletal muscle.MYOBLAST",
                "min": 0.113644,
                "q1": 6.0727,
                "median": 6.9462,
                "q3": 7.53683,
                "max": 9.63731,
            },
            "35": {
                "id": "System.Connective Tissue.Adipose tissue.ADIPOSE",
                "min": 4.26947,
                "q1": 6.18762,
                "median": 6.9462,
                "q3": 7.74633,
                "max": 8.57872,
            },
            "36": {
                "id": "System.Cardiovascular System.Heart.VALVE",
                "min": 5.21256,
                "q1": 6.4852,
                "median": 6.93534,
                "q3": 7.3445,
                "max": 7.88096,
            },
            "37": {
                "id": "System.Digestive System.Liver.HEPATOCYTE",
                "min": 5.43482,
                "q1": 6.50485,
                "median": 6.89949,
                "q3": 7.38198,
                "max": 8.40769,
            },
            "38": {
                "id": "System.Nervous System.CNS.MIDBRAIN",
                "min": 0.113644,
                "q1": 0.113644,
                "median": 6.89891,
                "q3": 7.68061,
                "max": 10.286,
            },
            "39": {
                "id": "System.Urogenital/Reproductive System.Ovary.OVARY",
                "min": 0.113644,
                "q1": 5.10633,
                "median": 6.88092,
                "q3": 7.98803,
                "max": 9.42561,
            },
            "40": {
                "id": "System.Connective Tissue.Adipose tissue.ADIPOCYTE",
                "min": 4.86561,
                "q1": 6.4358,
                "median": 6.88087,
                "q3": 7.13293,
                "max": 7.71929,
            },
            "41": {
                "id": "System.Immune System.Myeloid.DENDRITIC CELL",
                "min": 4.2942,
                "q1": 6.48802,
                "median": 6.88087,
                "q3": 7.39734,
                "max": 8.09957,
            },
            "42": {
                "id": "System.Immune System.Myeloid.MICROGLIA",
                "min": 0.113644,
                "q1": 6.24863,
                "median": 6.87137,
                "q3": 7.73386,
                "max": 9.34744,
            },
            "43": {
                "id": "System.Muscular System.Smooth muscle.AIRWAY SMOOTH MUSCLE",
                "min": 6.26415,
                "q1": 6.59685,
                "median": 6.85317,
                "q3": 7.10033,
                "max": 7.57266,
            },
            "44": {
                "id": "System.Digestive System.Esophagus.ESOPHAGUS",
                "min": 0.113644,
                "q1": 5.95023,
                "median": 6.8453,
                "q3": 8.1174,
                "max": 9.13015,
            },
            "45": {
                "id": "System.Integumentary System.Skin.FIBROBLAST",
                "min": 0.113644,
                "q1": 6.35023,
                "median": 6.8453,
                "q3": 7.43403,
                "max": 9.31767,
            },
            "46": {
                "id": "System.Immune System.Myeloid.KUPFFER CELL",
                "min": 6.16327,
                "q1": 6.30429,
                "median": 6.81385,
                "q3": 7.26722,
                "max": 7.45498,
            },
            "47": {
                "id": "System.Immune System.Spleen.SPLEEN",
                "min": 0.113644,
                "q1": 5.91845,
                "median": 6.78736,
                "q3": 7.57981,
                "max": 9.53567,
            },
            "48": {
                "id": "System.Digestive System.Intestine.COLON",
                "min": 2.77595,
                "q1": 5.81111,
                "median": 6.7824,
                "q3": 7.43403,
                "max": 8.92335,
            },
            "49": {
                "id": "System.Muscular System.Smooth muscle.VASCULAR SMOOTH MUSCLE",
                "min": 6.25904,
                "q1": 6.49365,
                "median": 6.76675,
                "q3": 7.04658,
                "max": 7.48914,
            },
            "50": {
                "id": "System.Connective Tissue.Bone.OSTEOBLAST",
                "min": 5.8662,
                "q1": 6.50485,
                "median": 6.76229,
                "q3": 7.09037,
                "max": 7.60665,
            },
            "51": {
                "id": "System.Muscular System.Smooth muscle.MYOFIBROBLAST",
                "min": 5.48696,
                "q1": 6.09783,
                "median": 6.73635,
                "q3": 7.12726,
                "max": 8.55558,
            },
            "52": {
                "id": "System.Digestive System.Liver.HEPATIC STELLATE CELL",
                "min": 5.69901,
                "q1": 6.46517,
                "median": 6.68963,
                "q3": 6.9657,
                "max": 7.38969,
            },
            "53": {
                "id": "System.Integumentary System.Skin.SKIN",
                "min": 0.113644,
                "q1": 5.78326,
                "median": 6.67736,
                "q3": 7.29406,
                "max": 9.14276,
            },
            "54": {
                "id": "System.Nervous System.CNS.OLIGODENDROCYTE",
                "min": 5.83491,
                "q1": 6.30103,
                "median": 6.61965,
                "q3": 7.10985,
                "max": 8.01128,
            },
            "55": {
                "id": "System.Digestive System.Intestine.COLON MUCOSA",
                "min": 5.12981,
                "q1": 6.20187,
                "median": 6.57726,
                "q3": 7.53042,
                "max": 8.28634,
            },
            "56": {
                "id": "System.Connective Tissue.Bone marrow.BONE MARROW",
                "min": 0.113644,
                "q1": 0.113644,
                "median": 6.53965,
                "q3": 7.87338,
                "max": 10.3072,
            },
            "57": {
                "id": "System.Immune System.Thymus.THYMUS",
                "min": 3.15607,
                "q1": 5.66417,
                "median": 6.51689,
                "q3": 7.24418,
                "max": 8.76301,
            },
            "58": {
                "id": "System.Immune System.Granulocytic.NEUTROPHIL",
                "min": 4.63174,
                "q1": 6.05806,
                "median": 6.50485,
                "q3": 6.9754,
                "max": 7.93693,
            },
            "59": {
                "id": "System.Digestive System.Liver.LIVER",
                "min": 1.20968,
                "q1": 5.31558,
                "median": 6.45202,
                "q3": 7.14364,
                "max": 8.31069,
            },
            "60": {
                "id": "System.Nervous System.CNS.PONS",
                "min": 0.113644,
                "q1": 5.18213,
                "median": 6.38743,
                "q3": 7.09227,
                "max": 8.77715,
            },
            "61": {
                "id": "System.Nervous System.CNS.CEREBRAL CORTEX",
                "min": 5.46218,
                "q1": 6.00069,
                "median": 6.31244,
                "q3": 6.79075,
                "max": 7.27026,
            },
            "62": {
                "id": "System.Digestive System.Intestine.SMALL INTESTINE",
                "min": 3.16194,
                "q1": 5.41928,
                "median": 6.30103,
                "q3": 7.03818,
                "max": 8.72686,
            },
            "63": {
                "id": "System.Urogenital/Reproductive System.Testis.TESTIS",
                "min": 0.113644,
                "q1": 4.03056,
                "median": 6.28103,
                "q3": 8.01398,
                "max": 9.55458,
            },
            "64": {
                "id": "System.Digestive System.Intestine.INTESTINAL EPITHELIAL CELL",
                "min": 3.61859,
                "q1": 5.46865,
                "median": 6.23115,
                "q3": 7.02906,
                "max": 8.10728,
            },
            "65": {
                "id": "System.Integumentary System.Skin.HAIR FOLLICLE",
                "min": 0.113644,
                "q1": 4.80649,
                "median": 6.18762,
                "q3": 6.59344,
                "max": 8.853,
            },
            "66": {
                "id": "System.Nervous System.CNS.CEREBELLUM",
                "min": 3.05618,
                "q1": 4.47438,
                "median": 5.90239,
                "q3": 6.81895,
                "max": 8.04888,
            },
            "67": {
                "id": "System.Nervous System.CNS.MEDULLA",
                "min": 3.05618,
                "q1": 4.25231,
                "median": 5.63312,
                "q3": 6.79623,
                "max": 8.62566,
            },
            "68": {
                "id": "System.Nervous System.CNS.SPINAL CORD",
                "min": 3.76961,
                "q1": 4.67269,
                "median": 5.59303,
                "q3": 6.18762,
                "max": 7.11222,
            },
            "69": {
                "id": "System.Urogenital/Reproductive System.Kidney.RENAL CORTEX",
                "min": 3.36466,
                "q1": 4.37809,
                "median": 4.88649,
                "q3": 5.74787,
                "max": 7.45099,
            },
            "70": {
                "id": "System.Digestive System.Pancreas.PANCREATIC ISLET",
                "min": 0.113644,
                "q1": 0.113644,
                "median": 1.20968,
                "q3": 8.13314,
                "max": 10.6156,
            },
            "71": {
                "id": "System.Immune System.Lymphoid.PLASMA CELL",
                "min": 0.113644,
                "q1": 0.113644,
                "median": 0.113644,
                "q3": 7.00873,
                "max": 9.39521,
            },
        }

        self.assertEqual(result_to_test, expected_result)

    def test_archs4_tissue_mouse(self):
        df = archs4("fuNdC1", which="tissue", species="mouse")
        result_to_test = df.values.tolist()
        expected_result = ARCHS4_FUNDC1_TISSUE_MOUSE

        self.assertListEqual(result_to_test, expected_result)

    def test_archs4_bad_gene(self):
        result = archs4("BANANA")
        self.assertIsNone(result, "Invalid gene result is not None.")

    def test_archs4_bad_gene_tissue(self):
        result = archs4("BANANA", which="tissue", species="mouse")
        self.assertIsNone(result, "Invalid gene result is not None.")

    def test_archs4_bad_which(self):
        with self.assertRaises(ValueError):
            archs4("OAS1", which="banana")

    def test_archs4_bad_species(self):
        with self.assertRaises(ValueError):
            archs4("OAS1", species="banana")
